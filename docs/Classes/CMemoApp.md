# `CMemoApp`

Implemented in [`MemoApp.h`](../../MemoPad/MemoPad/MemoApp.h) / [`MemoApp.cpp`](../../MemoPad/MemoPad/MemoApp.cpp)

This class represents an application object of 'MemoPad'.

In the outline generated by Visual Studio,
there is one
[`CWinApp`](https://learn.microsoft.com/en-us/cpp/mfc/reference/cwinapp-class)
derived class always for an
[MFC](https://en.wikipedia.org/wiki/Microsoft_Foundation_Class_Library)
application.
When the application is launched,
this class is called first to initialize the process.

In general,
Visual Studio applies 
'[Document/View Architecture](https://learn.microsoft.com/en-us/cpp/mfc/document-view-architecture)'
for a MFC application like Notepad ( in the sense that application does load/edit/save ).
In that architecture,
[CWinApp](https://learn.microsoft.com/en-us/cpp/mfc/reference/cwinapp-class)
construct a 'trinity' consists of:
* [Main Frame class](https://learn.microsoft.com/en-us/cpp/mfc/reference/cframewnd-class)
* [Document class](https://learn.microsoft.com/en-us/cpp/mfc/reference/cdocument-class)
* [View class](https://learn.microsoft.com/en-us/cpp/mfc/reference/cview-class)

But this application did not get along with that architecture.

* Omitted the [Document class](https://learn.microsoft.com/en-us/cpp/mfc/reference/cdocument-class)
* Use [`CEdit`](https://learn.microsoft.com/en-us/cpp/mfc/reference/cedit-class) derived class instead of the [View class](https://learn.microsoft.com/en-us/cpp/mfc/reference/cview-class)

This simple outline is enough to implement this application.

This class does create a [Main Frame](CMainFrame.md).
The [Main Frame](CMainFrame.md) creates a ['*view*'](CMemoView.md) which is not a
[real view](https://learn.microsoft.com/en-us/cpp/mfc/reference/cview-class)
but a [`CEdit`](https://learn.microsoft.com/en-us/cpp/mfc/reference/cedit-class) derived class.
The ['*view*'](CMemoView.md) does load/edit/save, etc. almost everything to work as a simple editor like Notepad.




## Overridden Functions



### `void InitInstance( void )`

Initializes the instance of 
[`CWinApp`](https://learn.microsoft.com/en-us/cpp/mfc/reference/cwinapp-class)

This method is to override the initialization of the
[`CWinApp`](https://learn.microsoft.com/en-us/cpp/mfc/reference/cwinapp-class)
class. ( And everyone override this. )

Overridden here to select a key of registry, create a [Main Frame](CMainFrame.md) and show it.
This function does not construct a 'trinity' as default skeleton do for
'[Document/View Architecture](https://learn.microsoft.com/en-us/cpp/mfc/document-view-architecture)'
which is generated by Visual Studio.


### `int DoMessageBox( LPCTSTR lpszPrompt, UINT nType, UINT nIDPrompt )`

Popups
[`AfxMessageBox()`](https://learn.microsoft.com/en-us/cpp/mfc/reference/cstring-formatting-and-message-box-display#afxmessagebox)

Overridden here to change the endpoint function of
[`AfxMessageBox()`](https://learn.microsoft.com/en-us/cpp/mfc/reference/cstring-formatting-and-message-box-display#afxmessagebox).

This function calls
[`MessageDlg()`](CMainFrame.md#messagedlg-lpszprompt-ntype-)
instead of default
[`CWinApp::DoMessageBox`](https://learn.microsoft.com/en-us/cpp/mfc/reference/cwinapp-class#domessagebox).



## Message Handlers

### `void OnInfoOnWeb( void )`

Handles [`WM_COMMAND`](https://learn.microsoft.com/en-us/windows/win32/menurc/wm-command)
message with `ID_HELP_INDEX` in `WPARAM`
to take action for `Help` menu's `View info on website`

( The ID `ID_HELP_INDEX` is not concerned with 'View info on website',
just applied as a unique identifier from the stock of predefined IDs. )

The action is to open the
[website of MemoPad](https://github.com/inhouse-tool/MemoPad)
with your browser


### `void OnLicense( void )`

Handles [`WM_COMMAND`](https://learn.microsoft.com/en-us/windows/win32/menurc/wm-command)
message with `ID_HELP_USING` in `WPARAM`
to take action for `Help` menu's `License Announcement`

( The ID `ID_HELP_USING` is not concerned with 'License Announcement',
just applied as a unique identifier from the stock of predefined IDs. )

The action is to show a license announcement in a modal dialog which is '*darkened*'.


### `void OnAppAbout( void )`

Handles [`WM_COMMAND`](https://learn.microsoft.com/en-us/windows/win32/menurc/wm-command)
message with `ID_APP_ABOUT` in `WPARAM`
to take action for `Help` menu's `About MemoPad`

The action is to show information about this application in a modal dialog which is '*darkened*'.
